---
title: "Aspectos sociais"
editor: visual
authors: 
- Caio Gonçalves 
- Vitor Marinho
---

## Como está a situação social nos municípios do Vale do Lítio de maneira geral?

O Índice Mineiro de Responsabilidade Social (IMRS) é uma métrica multidimensional que avalia a responsabilidade social na gestão pública estadual, compreendendo a implementação, pela administração pública, de políticas, planos, programas, projetos e ações destinados a garantir o acesso da população a serviços essenciais em áreas estratégicas, como educação, saúde, segurança pública, vulnerabilidade, saneamento e meio ambiente.

Ao utilizar esse índice com dados de 2019 a 2021 e fazer uma comparação entre os 853 municípios do estado, destacam-se os seguintes pontos:

-   Em termos gerais, nenhum dos municípios do Vale do Lítio figura entre os 100 municípios mais responsáveis socialmente. Pelo contrário, muitos deles ocupam posições inferiores no *ranking*, com dois deles, Medina e Itinga, sendo classificados entre os 100 municípios menos responsáveis socialmente;

-   Entre os 14 municípios do Vale do Lítio, na área da educação, destacaram-se positivamente Capelinha e Salinas. Na saúde, Malacacheta apresentou o melhor desempenho, enquanto Teófilo Otoni se sobressai na segurança pública e vulnerabilidade. Além disso, Capelinha destacou-se também em saneamento.

-   Considerando-se este indicador, percebe-se que a priorização na formulação de políticas públicas deve atender a diferentes necessidades em cada um dos municípios. Ao utilizar um recorte nos *ranking* das dimensões inferiores a 600ª posição, ou seja, entre o grupo dos 30% dos municípios de Minas Gerais mais carentes, tem-se as seguintes indicações de priorização por dimensão:

1.  **Educação**: Itinga, Minas Novas e Virgem da Lapa;

2.  **Saúde**: Itinga, Rubelita, Itaobim e Araçuaí;

3.  **Segurança pública**: Pedra Azul, Medina e Araçuaí;

4.  **Vulnerabilidade**: Itaobim, Pedra Azul e todos do **Grupo 4** (Coronel Murta, Itinga, Rubelita e Virgem da Lapa);

5.  **Saneamento básico**: Itaobim, Coronel Murta, Itinga, Medina e Malacacheta.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
##----------- Dev tabela 00 - imrs
library(readxl)
library(tidyverse)
library(gt)
imrs<- read.csv2("bases/imrs_2020.csv")
# Crie um DataFrame com as colunas "Municipio" e "IBGE7"
df_nome <- data.frame(
  Nome_munic = c(
    "Araçuaí",
    "Capelinha",
    "Coronel Murta",
    "Itaobim",
    "Itinga",
    "Malacacheta",
    "Medina",
    "Minas Novas",
    "Pedra Azul",
    "Teófilo Otoni",
    "Turmalina",
    "Rubelita",
    "Virgem da Lapa",
    "Salinas"
  ),
  ibge7 = c(
    3103405,
    3112307,
    3119500,
    3133303,
    3134004,
    3139201,
    3141405,
    3141801,
    3148707,
    3168606,
    3169703,
    3156502,
    3171600,
    3157005
  ),
  vale_do_litio = rep(1,14)
)


### definir paleta de cores 
my_pal <- scales::col_numeric(
  paletteer::paletteer_d(
    palette = "ggsci::red_material"
    ) %>% as.character(),
  domain = NULL
  )



tabela00_social <- left_join(imrs,df_nome) %>% 
  mutate(Grupo = case_when(
    Nome_munic == "Teófilo Otoni" ~ "Grupo 1",
    Nome_munic == "Salinas" | Nome_munic == "Capelinha" | Nome_munic == "Araçuaí" ~ "Grupo 2",
    Nome_munic == "Pedra Azul" | Nome_munic == "Minas Novas" | Nome_munic == "Medina" |
    Nome_munic == "Turmalina" | Nome_munic == "Itaobim" | Nome_munic == "Malacacheta" ~ "Grupo 3",
    Nome_munic == "Itinga" | Nome_munic == "Virgem da Lapa" | Nome_munic == "Coronel Murta" |
    Nome_munic == "Rubelita" ~ "Grupo 4"),
    ranking_imrs = rank(-imrs_2020, ties.method = "min"),
                  ranking_imrs_educacao = rank(-imrs_educ_2020, ties.method = "min"),
        ranking_imrs_saude = rank(-imrs_saude_2020, ties.method = "min"),
         ranking_imrs_seguranca = rank(-imrs_seg_2020, ties.method = "min"),
         ranking_imrs_vulnerabilidade = rank(-imrs_vuln_2020, ties.method = "min"),
         ranking_imrs_saneamento = rank(-imrs_saneam_2020, ties.method = "min")) %>% 
  filter(vale_do_litio==1) %>% arrange(Grupo) %>% 
  select(-ibge7, -Municipio,-imrs_2020, -imrs_educ_2020, -imrs_vuln_2020,
         -imrs_saude_2020, -imrs_seg_2020, -imrs_saneam_2020, -vale_do_litio)

### Marcar os os 30% mais carentes na tabela do IMRS
tabela00_social <- tabela00_social %>%
  group_by(Grupo) %>%
  mutate(is_carente = ranking_imrs >= quantile(ranking_imrs, 0.7)) %>%
  ungroup()


 tabela00_social %>%
  select(-is_carente) %>%  # Removendo a coluna 'is_carente' antes de passar para gt()
  gt() %>%
  tab_header(
    title = "Ranking do IMRS geral e por dimensões",
    subtitle = md("Municípios do Vale do Lítio - 2020")
  ) %>%
  cols_label(
    Nome_munic = 'Município',
    ranking_imrs = 'Ranking IMRS',
    ranking_imrs_educacao = 'Ranking IMRS Educação',
    ranking_imrs_saude = 'Ranking IMRS Saúde',
    ranking_imrs_seguranca = 'Ranking IMRS Segurança',
    ranking_imrs_vulnerabilidade = 'Ranking IMRS Vulnerabilidade',
    ranking_imrs_saneamento = 'Ranking IMRS Saneamento'
  ) %>%
  tab_style(
    style = cell_fill(color = "lightcoral"),
    locations = cells_body(
      columns = vars(ranking_imrs),
      rows = tabela00_social$is_carente
    )
  ) %>%
  data_color(
    columns = vars(ranking_imrs, ranking_imrs_educacao, ranking_imrs_saude, ranking_imrs_seguranca, ranking_imrs_vulnerabilidade, ranking_imrs_saneamento),
    colors = my_pal
  ) %>%
  opt_align_table_header(align = "left") %>%
  opt_table_font(font = google_font(name = "Karla")) %>%
  tab_options(
    data_row.padding = px(6),
    heading.align = 'left',
    column_labels.background.color = 'dodgerblue4',
    heading.title.font.size = px(20)
  ) %>%
  tab_stubhead(label = md("Region and <br />IAP Type")) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body()
  ) %>%
  tab_style(
    style = cell_text(color = 'dodgerblue4', weight = 'bold', font = google_font('Merriweather')),
    locations = cells_title(groups = 'title')
  )  %>% 
  tab_source_note(
    source_note = md("Fonte: FJP. 2020. Elaboração: FJP/Diretoria de Estatística e Informações. ")
  )
```

### GINI

A análise dos índices de Gini dos municípios listados revela tendências distintas de desigualdade ao longo das três décadas consideradas (1991, 2000 e 2010). O Município de Teófilo Otoni, pertencente ao Grupo 1, apresenta uma melhora progressiva, com uma redução contínua do índice, indicando uma diminuição na desigualdade de renda. Os municípios do Grupo 2 demonstram uma variabilidade maior: enquanto Capelinha e Araçuaí mostram reduções após flutuações, Salinas exibe um aumento significativo da desigualdade em 2010. No Grupo 3, exceto por uma oscilação notável em Itaobim e Malacacheta, a maioria tende a uma redução do índice, sugerindo melhorias nas condições de equidade. Por fim, os municípios do Grupo 4 apresentam uma tendência mais estável e geralmente positiva, com uma diminuição notável na desigualdade, especialmente em Rubelita, que após atingir o pico em 2000, retorna a um índice mais equitativo em 2010. Essas dinâmicas sugerem intervenções socioeconômicas variadas, que impactaram de forma diferenciada a distribuição de renda nessas localidades.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Criando o vetor com os municípios
municipios <- c("Teófilo Otoni", "Araçuaí", "Capelinha", "Salinas", "Itaobim", "Malacacheta", "Medina", "Minas Novas", "Pedra Azul", "Turmalina", "Coronel Murta", "Itinga", "Rubelita", "Virgem da Lapa")

# Criando os vetores com os dados para cada ano
ano_1991 <- c(0.620, 0.560, 0.590, 0.520, 0.480, 0.540, 0.610, 0.530, 0.560, 0.510, 0.490, 0.510, 0.480, 0.500)
ano_2000 <- c(0.600, 0.620, 0.570, 0.580, 0.610, 0.660, 0.560, 0.530, 0.600, 0.550, 0.530, 0.600, 0.700, 0.600)
ano_2010 <- c(0.570, 0.570, 0.520, 0.650, 0.510, 0.530, 0.570, 0.500, 0.530, 0.500, 0.490, 0.500, 0.500, 0.490)

# Criando o DataFrame
df_gini <- data.frame(Municipios = municipios, 
                 "1991" = ano_1991, 
                 "2000" = ano_2000, 
                 "2010" = ano_2010)

df_gini <- df_gini %>% 
  mutate(Grupo = case_when(
    Municipios  == "Teófilo Otoni" ~ "Grupo 1",
    Municipios  %in% c("Salinas", "Capelinha", "Araçuaí") ~ "Grupo 2",
    Municipios  %in% c("Pedra Azul", "Minas Novas", "Medina", "Turmalina", "Itaobim", "Malacacheta") ~ "Grupo 3",
    Municipios  %in% c("Itinga", "Virgem da Lapa", "Coronel Murta", "Rubelita") ~ "Grupo 4"
  )) %>%
  arrange(Grupo) %>%
  group_by(Grupo) 


# Exibindo o DataFrame
df_gini %>% 
  gt() %>%
  tab_header(
    title = "GINI"
  ) %>%
  cols_label(
    Municipios  = "Município"
  ) %>%
  fmt_number(
    columns = vars(2:4),
    decimals = 2,
    dec_mark = ',',
    sep_mark = '.'
  ) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body(columns = vars(2:4))
  ) %>%
  tab_options(
    data_row.padding = px(6),
    heading.align = 'left',
    column_labels.background.color = 'dodgerblue4',
    heading.title.font.size = px(26)
  ) %>%
  tab_style(
    style = cell_text(color = 'dodgerblue4', weight = 'bold'),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label( Municipios = "Município",
              X1991 = '1991',
              X2000 = '2000',
              X2010 = '2010')  %>%
  tab_source_note(source_note = md("Fonte: IBGE. Elaboração: FJP/Diretoria de Estatística e Informações. ")) 
 

```

### IDHM

A evolução do Índice de Desenvolvimento Humano Municipal (IDHM) para os municípios citados reflete melhorias significativas entre 1991 e 2010. Observa-se uma tendência geral de crescimento contínuo nos índices, indicando avanços nas dimensões de educação, saúde e renda.

Teófilo Otoni se destaca com o maior IDHM em 2010 e um aumento consistente ao longo dos anos, refletindo possíveis políticas efetivas de desenvolvimento social e econômico. Em contraste, apesar das melhorias, municípios como Rubelita e Itinga apresentam os menores índices em 2010 e figuram entre os últimos no ranking, o que pode indicar desafios persistentes nessas áreas.

Os municípios de Araçuaí, Capelinha e Salinas também mostram uma trajetória de crescimento, mas com variações em suas posições no ranking de 2010, sugerindo que, apesar dos avanços, ainda enfrentam desafios para alcançar níveis mais altos de desenvolvimento humano em comparação com outras regiões.

De forma geral, todos os municípios analisados apresentaram melhorias no IDHM ao longo das duas décadas, o que demonstra um progresso considerável. No entanto, a variação entre eles no ranking de 2010 aponta para a necessidade de estratégias diferenciadas e focadas para enfrentar as especificidades de cada município na busca por um desenvolvimento humano mais equitativo e sustentável.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Criando o vetor com os municípios
municipios <- c("Teófilo Otoni", "Araçuaí", "Capelinha", "Salinas", "Itaobim", "Malacacheta", "Medina", "Minas Novas", "Pedra Azul", "Turmalina", "Coronel Murta", "Itinga", "Rubelita", "Virgem da Lapa")

# Criando os vetores com os dados para cada ano
idhm_1991 <- c(0.440, 0.338, 0.355, 0.368, 0.369, 0.321, 0.326, 0.282, 0.364, 0.308, 0.334, 0.276, 0.266, 0.348)
idhm_2000 <- c(0.589, 0.516, 0.490, 0.535, 0.542, 0.482, 0.477, 0.421, 0.516, 0.516, 0.515, 0.440, 0.442, 0.513)
idhm_2010 <- c(0.701, 0.663, 0.653, 0.679, 0.629, 0.618, 0.624, 0.633, 0.627, 0.682, 0.627, 0.600, 0.582, 0.610)
ranking_2010 <- c(223, 469, 529, 364, 660, 721, 699, 637, 675, 347, 669, 778, 815, 750)

# Criando o DataFrame
df_idhm <- data.frame(Municípios = municipios, 
                 "IDHM 1991" = idhm_1991, 
                 "IDHM 2000" = idhm_2000, 
                 "IDHM 2010" = idhm_2010,
                 "Ranking 2010" = ranking_2010)

# Renomeando as colunas
names(df_gini)[names(df_gini) == "X1991"] <- "IDHM_1991"
names(df_gini)[names(df_gini) == "X2000"] <- "IDHM_2000"
names(df_gini)[names(df_gini) == "X2010"] <- "IDHM_2010"

# tabela
df_idhm %>% 
  gt() %>%
  tab_header(
    title = "IDHM"
  ) %>%
  fmt_number(
    columns = vars(IDHM.1991:IDHM.2010),
    decimals = 2,
    dec_mark = ',',
    sep_mark = '.'
  ) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body(columns = vars(IDHM.1991:IDHM.2010))
  ) %>%
  tab_options(
    data_row.padding = px(6),
    heading.align = 'left',
    column_labels.background.color = 'dodgerblue4',
    heading.title.font.size = px(26)
  ) %>%
  tab_style(
    style = cell_text(color = 'dodgerblue4', weight = 'bold'),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(IDHM.1991 = '1991',
             IDHM.2000 = '2000',
             IDHM.2010 = '2010',
             Ranking.2010 = 'Ranking 2010')  %>%
  tab_source_note(source_note = md("Fonte: PNUD. Elaboração: FJP/Diretoria de Estatística e Informações. "))



```

### Taxa de analfabetismo

A taxa de analfabetismo nos municípios listados mostra uma tendência de declínio geral entre os Censos de 2000 e 2010, com uma continuação dessa tendência em muitos municípios até 2021, conforme dados do Cadastro Único. Isso reflete avanços importantes na educação básica dessas localidades.

Por exemplo, Teófilo Otoni apresentou uma diminuição substancial de 18,35% em 2000 para 12,66% em 2021, evidenciando melhorias consistentes no acesso e na qualidade da educação. Araçuaí, notavelmente, reduziu sua taxa de analfabetismo de 23,66% em 2000 para 7,53% em 2021, um dos melhores desempenhos entre os municípios analisados.

Alguns municípios, como Malacacheta e Minas Novas, ainda exibem taxas relativamente altas de analfabetismo em 2021, apesar das reduções ao longo dos anos. Isso sugere que, embora haja progresso, ainda existem desafios significativos que precisam ser abordados para alcançar uma erradicação mais completa do analfabetismo.

Em contraste, Turmalina e Medina destacam-se por suas significativas reduções na taxa de analfabetismo desde 2000, com Turmalina atingindo uma impressionante taxa de 7,27% em 2021. Esses resultados podem indicar a implementação de políticas públicas eficazes e programas focados em educação adulta e alfabetização.

De modo geral, a redução das taxas de analfabetismo é um indicativo positivo de desenvolvimento social e de investimentos em educação, mas o ritmo e a extensão dessas reduções variam significativamente entre os municípios, refletindo diferenças na eficácia das políticas públicas locais e nos recursos disponíveis.

```{r,  echo=FALSE, warning=FALSE, message=FALSE}
# Criar o data frame
df_analfabetismo <- data.frame(
  Municipios = c("Teófilo Otoni", "Araçuaí", "Capelinha", "Salinas", "Itaobim", "Malacacheta",
                 "Medina", "Minas Novas", "Pedra Azul", "Turmalina", "Coronel Murta", "Itinga", 
                 "Rubelita", "Virgem da Lapa"),
  `Censo Demográfico 2000` = c(18.35, 23.66, 26.70, 23.85, 26.73, 31.88, 29.78, 33.53, 27.88, 22.53, 23.76, 31.02, 28.96, 27.75),
  `Censo Demográfico 2010` = c(12.95, 17.35, 18.94, 17.28, 20.96, 25.22, 22.45, 23.00, 20.10, 14.94, 19.75, 22.18, 24.43, 22.18),
  `CadÚnico 2014` = c(14.70, 9.31, 13.68, 10.08, 15.37, 18.17, 13.14, 21.03, 16.30, 6.74, 13.63, 12.93, 15.40, 13.04),
  `CadÚnico 2021` = c(12.66, 7.53, 12.44, 10.50, 14.64, 17.55, 10.83, 16.32, 18.57, 7.27, 12.31, 12.11, 12.11, 9.43)
)

# Printar o data frame
df_analfabetismo %>%
  gt() %>%
  tab_header(
    title = "Taxa de analfabetismo da população de 15 anos ou mais"
  ) %>%
  fmt_number(
    columns = vars(Censo.Demográfico.2000:CadÚnico.2021),
    decimals = 2,
    dec_mark = ',',
    sep_mark = '.'
  ) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body(columns = vars(Censo.Demográfico.2000:CadÚnico.2021))
  ) %>%
  tab_options(
    data_row.padding = px(6),
    heading.align = 'left',
    column_labels.background.color = 'dodgerblue4',
    heading.title.font.size = px(26)
  ) %>%
  tab_style(
    style = cell_text(color = 'dodgerblue4', weight = 'bold'),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(Censo.Demográfico.2000 = 'Censo 2000',
             Censo.Demográfico.2010 = 'Censo 2010',
             CadÚnico.2014 = 'CadÚnico 2014',
             CadÚnico.2021 = 'CadÚnico 2021')  %>%
  tab_source_note(source_note = md("Fonte: IBGE/CadUnico. Elaboração: FJP/Diretoria de Estatística e Informações. "))


```

## O que revelam os principais indicadores da área da educação, saúde, assistência social, segurança pública e saneamento básico?

### Educação

A taxa de atendimento escolar na educação básica é um indicador de acesso ao sistema educacional. Essa taxa se aproxima de 100% em geral, mas alguns municípios apresentaram índices menores, como Virgem da Lapa (80,6%), Coronel Murta (84,5%), Minas Novas (86%) e Itinga (89,9%).

Para entender melhor a adequação entre a idade dos alunos e o ano escolar em que estão matriculados, é importante observar a taxa de distorção idade-série. Nos anos finais do ensino fundamental e no ensino médio, essa taxa observada revelou uma maior discrepância nos municípios de Teófilo Otoni, Itaobim, Malacacheta e Itinga, onde a idade dos alunos frequentemente não corresponde à série ideal.

Quanto à qualidade da educação, o Índice de Qualidade Geral da Educação fornece uma perspectiva abrangente. Esse índice é uma média ponderada dos indicadores de qualidade do ensino de Matemática e Língua Portuguesa. Esses indicadores são avaliados em três momentos cruciais da jornada educacional: no 5º e 9º anos do ensino fundamental e na 3ª série do ensino médio. A ponderação leva em conta o número de alunos que realizam o exame em cada disciplina, baseando-se nos dados do Programa de Avaliação da Rede Pública de Educação Básica (PROEB) de Minas Gerais. Entre os municípios do Vale do Lítio, Pedra Azul, Itinga e Rubelita se destacaram pelos resultados mais baixos em termos de qualidade geral da educação.

```{r, eval = FALSE, echo=FALSE, warning=FALSE, message=FALSE}

educ <- read_excel("dados/educ.xlsx", col_types = c("numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric", "numeric", "numeric", 
+     "numeric", "numeric"))


municipios_vale <- c(
  3103405,  # Araçuaí
  3112307,  # Capelinha
  3119500,  # Coronel Murta
  3133303,  # Itaobim
  3134004,  # Itinga
  3139201,  # Malacacheta
  3141405,  # Medina
  3141801,  # Minas Novas
  3148707,  # Pedra Azul
  3168606,  # Teófilo Otoni
  3169703,  # Turmalina
  3156502,  # Rubelita
  3171600,  # Virgem da Lapa
  3157005  # Salinas
)


tabela01_social<- educ %>%  left_join(df_nome) %>% select(Municipio, IBGE7, ANO,E_TXATBASICA, E_DISTEF, E_DISTEFAF, E_IQE)  %>% filter(IBGE7 %in% municipios_vale & ANO== 2021) %>% 
  select(Municipio, everything()) 

saveRDS(tabela01_social,'dados/tabela01_social.rds')
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(gt)

tabela01_social <- readRDS("dados/tabela01_social.rds") %>% 
    mutate( Grupo = case_when(
    Municipio == "Teófilo Otoni" ~ "Grupo 1",
    Municipio == "Salinas" | Municipio == "Capelinha" | Municipio == "Araçuaí" ~ "Grupo 2",
    Municipio == "Pedra Azul" | Municipio == "Minas Novas" | Municipio == "Medina" |
    Municipio == "Turmalina" | Municipio == "Itaobim" | Municipio == "Malacacheta" ~ "Grupo 3",
    Municipio == "Itinga" | Municipio == "Virgem da Lapa" | Municipio == "Coronel Murta" |
    Municipio == "Rubelita" ~ "Grupo 4")) %>%  arrange(Grupo) %>%  select(-IBGE7, -ANO)

tabela01_social  %>% 
  group_by(Grupo) %>% 
  gt() %>% 
  tab_header(
    title = "Indicadores educacionais selecionados",
    subtitle = md("Municípios do Vale do Lítio - 2021 (ou último ano disponível)")
  )%>%
  opt_align_table_header(align = "left") %>%
  tab_stubhead(label = md("Region and <br />IAP Type")) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body()
  )  %>% #rótulo
  opt_table_font(font = google_font(name = "Karla")) %>% 
  tab_options(data_row.padding = px(6),
              heading.align = 'left',
              column_labels.background.color = 'dodgerblue4',
              heading.title.font.size = px(20)) %>% 
  tab_style(
    style = cell_text(
      color = 'dodgerblue4', 
      weight = 'bold', 
      font = google_font('Merriweather')
    ),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(
    Municipio = "Município",
    E_TXATBASICA = 'Taxa de atendimento da educação básica (%)',
    E_DISTEF = 'Taxa de distorção idade séries nos anos finais do ensino fundamental (%)',
    E_DISTEFAF = 'Taxa de distorção idade séries nos anos finais do ensino médio (%)',
    E_IQE = 'Índice de Qualidade Geral da Educação '
  )  %>% 
  fmt_number(
    columns = 2:4,  # Seleciona colunas
    decimals = 1)  %>% 
  fmt_number(
    columns = 5,  # Seleciona colunas
    decimals = 2)  # Definir 2 casas decimais 

```

Fonte: @fjp2020imrs. Elaboração: FJP/Diretoria de Estatística e Informações.

### Saúde

Diversos indicadores são úteis para avaliar a situação da saúde nos municípios. Um deles é a taxa de mortalidade por doenças não transmissíveis, como neoplasias, diabetes, doenças cardiovasculares e doenças respiratórias crônicas, na faixa etária de 30 a 69 anos. Nesse aspecto, Rubelita, Virgem da Lapa e Medina se destacaram com taxas superiores a 300 óbitos por cada mil habitantes.

No que se refere à cobertura da vacina pentavalente, que protege contra Difteria, Tétano, Coqueluche, Meningite e outras infecções causadas pelo *Haemophilus Influenzae* Tipo B e a Hepatite B em crianças menores de um ano, os dados do Programa Nacional de Imunizações mostraram que Itaobim e Rubelita possuem as menores coberturas vacinais, abaixo de 50%.

Outros indicadores relevantes na área da saúde incluem a proporção de óbitos por causas mal definidas e as internações hospitalares por condições sensíveis à atenção primária. Esses indicadores apontaram para situações mais críticas nos municípios de Medina, Minas Novas e Teófilo Otoni para o primeiro caso, e em Malacacheta, Medina e Rubelita para o segundo.

```{r, eval = FALSE, eval=FALSE, echo=FALSE, warning=FALSE, message=FALSE}

library(readxl)
saude <- read_excel("dados/IMRS_BASE_SAUDE_2000-2021_2022_novembro.xlsx", 
    col_types = c("numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric"))


tabel02_social<- saude %>% left_join(df_nome) %>% select(Municipio, IBGE7, ANO,S_TXMODCNT30A69, S_PENTA, S_OBMALDEF, S_INTERSAP)  %>% filter(IBGE7 %in% municipios_vale & ANO== 2021) %>% 
  select(Municipio, everything())   

saveRDS(tabel02_social, 'tabela02_social.rds')
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

tabela02_social <- readRDS("dados/tabela02_social.rds")%>% 
    mutate( Grupo = case_when(
    Municipio == "Teófilo Otoni" ~ "Grupo 1",
    Municipio == "Salinas" | Municipio == "Capelinha" | Municipio == "Araçuaí" ~ "Grupo 2",
    Municipio == "Pedra Azul" | Municipio == "Minas Novas" | Municipio == "Medina" |
    Municipio == "Turmalina" | Municipio == "Itaobim" | Municipio == "Malacacheta" ~ "Grupo 3",
    Municipio == "Itinga" | Municipio == "Virgem da Lapa" | Municipio == "Coronel Murta" |
    Municipio == "Rubelita" ~ "Grupo 4")) %>%  arrange(Grupo) %>%  select(-IBGE7, -ANO)

# Truncando valores da S_PENTA para no máximo 100
tabela02_social <- tabela02_social %>%
  mutate(S_PENTA = pmin(S_PENTA, 100))



tabela02_social  %>% 
  group_by(Grupo) %>% 
  gt() %>% 
  tab_header(
    title = "Indicadores da saúde selecionados",
    subtitle = md("Municípios do Vale do Lítio - 2021")
  )%>%
  opt_align_table_header(align = "left") %>%
  tab_stubhead(label = md("Region and <br />IAP Type")) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body()
  )  %>% #rótulo
  opt_table_font(font = google_font(name = "Karla")) %>% 
  tab_options(data_row.padding = px(6),
              heading.align = 'left',
              column_labels.background.color = 'dodgerblue4',
              heading.title.font.size = px(20)) %>% 
  tab_style(
    style = cell_text(
      color = 'dodgerblue4', 
      weight = 'bold', 
      font = google_font('Merriweather')
    ),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(
    Municipio = "Município",
    S_TXMODCNT30A69 = 'Taxa de mortalidade por doenças crônicas não transmissíveis (por 100 mil hab.)',
    S_PENTA = 'Cobertura vacinal de pentavalente em menores de 1 ano (%)',
    S_OBMALDEF = 'Proporção de óbitos por causas mal definidas (%)',
    S_INTERSAP = 'Internações hospitalares por condições sensíveis à atenção primária (%)'
  )  %>% 
  fmt_number(
    columns = 2:6,  # Seleciona colunas
    decimals = 1)  # Definir 2 casas decimais 
```

Fonte: @fjp2020imrs. Elaboração: FJP/Diretoria de Estatística e Informações.

### Assistência Social

O percentual da população inscrita no Cadastro Único (CadÚnico) é um indicador que reflete a proporção dos habitantes cadastrados nos Programas Sociais do Governo Federal. Essa ferramenta é vital para identificar e caracterizar famílias de baixa renda, facilitando o direcionamento eficaz de políticas públicas. Uma alta porcentagem de inscrições no CadÚnico pode sugerir uma prevalência elevada de famílias com renda inferior no município, além de indicar a eficácia governamental em registrar aqueles que são elegíveis para receber benefícios sociais. Na região do Vale do Lítio, a maioria dos municípios registra mais da metade de sua população no CadÚnico, com Teófilo Otoni sendo a exceção. Em 2021, Rubelita se destacou com o maior percentual, onde 74,3% da população estava cadastrada.

Quanto ao percentual de população pobre e extremamente pobre registrada no CadÚnico, Rubelita e Pedra Azul exibiram taxas superiores a 70%. Essa estatística é essencial para compreender a dimensão da pobreza e da extrema pobreza nestes municípios. Já em relação às pessoas cadastradas no CadÚnico sem ocupação, Itinga, Araçuaí e Coronel Murta apresentaram os índices mais elevados. Um percentual alto nesse indicador pode apontar para problemas como desemprego ou subutilização da força de trabalho local. Isso também acena para políticas que fomentem a criação de empregos e ofereçam capacitação profissional, além de programas de assistência social para atender a esse segmento da população.

```{r, eval = FALSE, eval=FALSE, echo=FALSE, warning=FALSE, message=FALSE}

library(readxl)
ass_social <- read_excel("dados/ass_social.xlsx", 
    col_types = c("numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric", "numeric", 
        "numeric", "numeric"))


```

```{r, eval = FALSE, eval=FALSE, echo=FALSE, warning=FALSE, message=FALSE}

tabela03_social<- ass_social%>% left_join(df_nome) %>% select(Municipio, IBGE7, ANO,B_POPCADUNICO, B_POPPOBEXTRCAD, B_POPIDCADSPOP)  %>% filter(IBGE7 %in% municipios_vale & ANO== 2021) %>% 
  select(Municipio, everything())  

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

tabela03_social <- readRDS("dados/tabela03_social.rds")%>% 
    mutate( Grupo = case_when(
    Municipio == "Teófilo Otoni" ~ "Grupo 1",
    Municipio == "Salinas" | Municipio == "Capelinha" | Municipio == "Araçuaí" ~ "Grupo 2",
    Municipio == "Pedra Azul" | Municipio == "Minas Novas" | Municipio == "Medina" |
    Municipio == "Turmalina" | Municipio == "Itaobim" | Municipio == "Malacacheta" ~ "Grupo 3",
    Municipio == "Itinga" | Municipio == "Virgem da Lapa" | Municipio == "Coronel Murta" |
    Municipio == "Rubelita" ~ "Grupo 4")) %>%  arrange(Grupo) %>%  select(-IBGE7, -ANO)


tabela03_social  %>% 
  group_by(Grupo) %>% 
  gt() %>% 
  tab_header(
    title = "Indicadores de assistência social selecionados",
    subtitle = md("Municípios do Vale do Lítio - 2021")
  )%>%
  opt_align_table_header(align = "left") %>%
  tab_stubhead(label = md("Region and <br />IAP Type")) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body()
  )  %>% #rótulo
  opt_table_font(font = google_font(name = "Karla")) %>% 
  tab_options(data_row.padding = px(6),
              heading.align = 'left',
              column_labels.background.color = 'dodgerblue4',
              heading.title.font.size = px(20)) %>% 
  tab_style(
    style = cell_text(
      color = 'dodgerblue4', 
      weight = 'bold', 
      font = google_font('Merriweather')
    ),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(
    Municipio = "Município",
    B_POPCADUNICO = 'Percentual da população registrada no Cadastro Único ',
    B_POPPOBEXTRCAD = 'Percentual da população pobre e extremamente pobre do Cadastro Único',
    B_POPIDCADSPOP = 'Percentual das pessoas de 18 a 64 anos inscritas no CadÚnico sem ocupação'
  )  %>% 
  fmt_number(
    columns = 2:5,  # Seleciona colunas
    decimals = 1)  # Definir 2 casas decimais 
```

Fonte: @fjp2020imrs. Elaboração: FJP/Diretoria de Estatística e Informações.

### Segurança

Os indicadores de segurança pública são ferramentas para avaliar a situação de segurança e a eficácia das forças policiais em determinadas regiões ou países. Por exemplo, a taxa de ocorrência de homicídios dolosos, que reflete a frequência de homicídios intencionais por 100.000 habitantes, é um importante indicador. Em 2021, os municípios de Medina, Pedra Azul e Itinga registraram as maiores taxas. Uma alta incidência de homicídios dolosos geralmente sinaliza problemas mais profundos de segurança pública e pode estar relacionada a fatores como criminalidade organizada, tensões sociais ou políticas de segurança ineficientes.

Quanto à taxa de crimes violentos contra o patrimônio, como roubos e assaltos, observou-se que Medina, Pedra Azul e Rubelita apresentaram as taxas mais elevadas. Tais índices elevados podem comprometer a sensação de segurança entre a população e evidenciam a necessidade de implementar estratégias específicas para prevenir e combater esses crimes.

O número de habitantes por policial militar, por sua vez, serve como uma medida da densidade de policiamento em uma área. Uma proporção elevada de habitantes por policial pode indicar uma potencial escassez de efetivos, o que pode comprometer a eficácia das respostas policiais e a segurança como um todo. Em contrapartida, uma proporção mais baixa pode sugerir uma cobertura policial adequada, embora isso não assegure necessariamente maior eficiência na prevenção ou no combate ao crime. No Vale do Lítio, em 9 dos 14 municípios, a proporção é de mais de 700 habitantes por policial. Teófilo Otoni se destacou positivamente, com a melhor proporção do Vale do Lítio, apresentando 274 habitantes por policial.

```{r, eval = FALSE, eval=FALSE, echo=FALSE, warning=FALSE, message=FALSE}

library(readxl)

library(readxl)
seg_pub <- read_excel("seg_pub.xlsx", col_types = c("text", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric", "text", "numeric", "numeric", 
    "numeric", "numeric", "numeric", "numeric", 
    "numeric"))


tabela04_social<-  seg_pub %>%  left_join(df_nome)  %>%   select(Municipio, IBGE7, ANO,P_HOM_TX, P_CVPA,P_PM) %>%filter(IBGE7 %in% municipios_vale & ANO== 2021) %>% 
  select(Municipio, everything())  

saveRDS(tabela04_social, 'dados/tabela04_social.rds')

```

```{r, echo=FALSE, warning=FALSE, message=FALSE}

library(tidyverse)
library(gt)

tabela04_social <- readRDS("dados/tabela04_social.rds")%>% 
    mutate( Grupo = case_when(
    Municipio == "Teófilo Otoni" ~ "Grupo 1",
    Municipio == "Salinas" | Municipio == "Capelinha" | Municipio == "Araçuaí" ~ "Grupo 2",
    Municipio == "Pedra Azul" | Municipio == "Minas Novas" | Municipio == "Medina" |
    Municipio == "Turmalina" | Municipio == "Itaobim" | Municipio == "Malacacheta" ~ "Grupo 3",
    Municipio == "Itinga" | Municipio == "Virgem da Lapa" | Municipio == "Coronel Murta" |
    Municipio == "Rubelita" ~ "Grupo 4")) %>%  arrange(Grupo) %>%  select(-IBGE7, -ANO)


tabela04_social  %>% 
  group_by(Grupo) %>% 
  gt() %>% 
  tab_header(
    title = "Indicadores de segurança pública selecionados",
    subtitle = md("Municípios do Vale do Lítio - 2021")
  )%>%
  opt_align_table_header(align = "left") %>%
  tab_stubhead(label = md("Region and <br />IAP Type")) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body()
  )  %>% #rótulo
  opt_table_font(font = google_font(name = "Karla")) %>% 
  tab_options(data_row.padding = px(6),
              heading.align = 'left',
              column_labels.background.color = 'dodgerblue4',
              heading.title.font.size = px(20)) %>% 
  tab_style(
    style = cell_text(
      color = 'dodgerblue4', 
      weight = 'bold', 
      font = google_font('Merriweather')
    ),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(
    Municipio = "Município",
    P_HOM_TX = 'Taxa de ocorrência de homicídios dolosos (por 100 mil hab.)',
    P_CVPA = 'Taxa de crimes violentos contra o patrimônio (por 100 mil hab.)',
    P_PM = 'Número de habitantes por policial militar (hab./policial)'
  )  %>% 
  fmt_number(
    columns = 2:3,  # Seleciona colunas
    decimals = 1)  %>% 
  fmt_number(
    columns = 4,  # Seleciona colunas
    decimals = 0)  # Definir 2 casas decimais 
```

Fonte: @fjp2020imrs. Elaboração: FJP/Diretoria de Estatística e Informações.

### Saneamento

Diversos indicadores são fundamentais para avaliar a qualidade dos serviços de saneamento básico e a eficiência da gestão pública em prover infraestruturas essenciais para a saúde e qualidade de vida da população. Por exemplo, no Grupo 1, Teófilo Otoni destaca-se com uma taxa de conexão principal de 84,52%, o que indica uma boa infraestrutura de saneamento, embora ainda existam cerca de 6.953 domicílios sem acesso. Araçuaí, também no Grupo 1, tem uma taxa menor, com 78,52%, e um número significativo de residências sem conexão, refletindo desafios em alcançar uma cobertura mais universal.

Dentro do Grupo 2, Salinas apresenta a melhor taxa, com 91,72% dos domicílios conectados à rede principal, classificando-se bem acima em relação a outros municípios. Isso sugere uma infraestrutura de saneamento relativamente avançada e bem distribuída. Em contrapartida, Itaobim, embora também tenha uma boa taxa de 88,46%, mostra que ainda há espaço para melhorias.

No Grupo 3, Pedra Azul e Turmalina exibem taxas de conexão acima de 85%, destacando-se positivamente. No entanto, Malacacheta enfrenta desafios significativos com apenas 70,10% dos domicílios conectados à rede principal, o que indica a necessidade de investimentos substanciais em infraestrutura.

O Grupo 4 mostra as menores taxas de conexão principal, com Itinga e Rubelita apresentando menos de 70% de suas residências conectadas. Esses números são preocupantes e apontam para a necessidade urgente de intervenções para melhorar o acesso ao serviço básico de água.

Essa variabilidade nas taxas de conexão à rede de água sugere que, enquanto alguns municípios avançam na garantia de acesso à infraestrutura essencial, outros ainda enfrentam barreiras significativas, necessitando de políticas públicas focadas e investimentos para garantir a universalização do acesso aos serviços de água e saneamento.

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Criar o data frame
df_saneamento <- data.frame(
  Grupo = c("Grupo 1", "Grupo 1", "Grupo 2", "Grupo 2", "Grupo 2", "Grupo 3", "Grupo 3", 
            "Grupo 3", "Grupo 3", "Grupo 3", "Grupo 4", "Grupo 4", "Grupo 4", "Grupo 4"),
  Municipios = c("Teófilo Otoni", "Araçuaí", "Capelinha", "Salinas", "Itaobim", 
                 "Malacacheta", "Medina", "Minas Novas", "Pedra Azul", "Turmalina", "Coronel Murta", 
                 "Itinga", "Rubelita", "Virgem da Lapa"),
  Total = c(49858, 12188, 14149, 14892, 6895, 6424, 7244, NA, 7450, 7436, 2882, 4573, 2120, 4327),
  Ligacao_Rede_Principal = c(42141, 9570, 11742, 13659, 6099, 4503, 5482, NA, 6388, 6462, 2243, 3101, 1403, 3307),
  Ligacao_Rede_Outra_Forma = c(764, 221, 132, 91, 76, 214, 350, NA, 204, 250, 38, 86, 129, 183),
  Sem_Ligacao_Rede = c(6953, 2397, 2275, 1142, 720, 1707, 1412, NA, 858, 724, 601, 1386, 588, 837),
  Percentual_Ligacao_Rede_Principal = c(84.52, 78.52, 82.99, 91.72, 88.46, 70.10, 75.68, NA, 85.74, 86.90, 77.83, 67.81, 66.18, 76.43),
  Ranking = c(247, 393, 286, 108, 166, 562, 456, NA, 217, 196, 411, 597, 622, 444)
)


```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
# Criando a tabela usando o pacote gt
 df_saneamento %>%
  gt() %>%
  tab_header(
    title = "Conexão dos domicílios à rede geral de água"
  ) %>%
  fmt_number(
    columns = vars(Total, Ligacao_Rede_Principal, Ligacao_Rede_Outra_Forma, Sem_Ligacao_Rede, Percentual_Ligacao_Rede_Principal),
    decimals = 2,
    dec_mark = ',',
    sep_mark = '.'
  ) %>%
  tab_style(
    style = cell_text(size = "smaller"),
    locations = cells_body(columns = vars(Total, Ligacao_Rede_Principal, Ligacao_Rede_Outra_Forma, Sem_Ligacao_Rede, Percentual_Ligacao_Rede_Principal))
  ) %>%
  tab_options(
    data_row.padding = px(6),
    heading.align = 'left',
    column_labels.background.color = 'dodgerblue4',
    heading.title.font.size = px(26)
  ) %>%
  tab_style(
    style = cell_text(color = 'dodgerblue4', weight = 'bold'),
    locations = cells_title(groups = 'title')
  ) %>%
  cols_label(
    Total = 'Total de Domicílios',
    Ligacao_Rede_Principal = 'Conexão Principal à Rede',
    Ligacao_Rede_Outra_Forma = 'Conexão Secundária à Rede',
    Sem_Ligacao_Rede = 'Sem Conexão à Rede',
    Percentual_Ligacao_Rede_Principal = '(%) Conexão Principal'
  ) %>%
  tab_source_note(source_note = md("Fonte: IBGE. Elaboração: Diretoria de Estatística e Informações."))
```
